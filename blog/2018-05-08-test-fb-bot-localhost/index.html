<!doctype html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Font -->
  <link rel="preload" as="font" href="/ego/fonts/vendor/jost/jost-v4-latin-regular.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="/ego/fonts/vendor/jost/jost-v4-latin-700.woff2" type="font/woff2" crossorigin>

  <!-- script -->
  <script src="/ego/js/darkmode-init.js"></script>
  <!-- stylesheet -->
  <link rel="stylesheet" href="/ego/css/main.css" crossorigin="anonymous">
  <noscript><style>img.lazyload { display: none; }</style></noscript>

  <!-- seo -->
 

  <!-- Favicon -->
  <meta name="theme-color" content="">
  <link rel="apple-touch-icon" sizes="180x180" href="/ego/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/ego/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/ego/favicon-16x16.png">
  <link rel="manifest" crossorigin="use-credentials" href="/ego/site.webmanifest">

</head>


  <body class="blog list">
     <div class="header-bar"></div>

<header class="navbar navbar-expand-md navbar-light doks-navbar">
  <nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation">
    <a class="navbar-brand p-0 me-auto" href="/" aria-label="Ego">
      Ego
    </a>

    <button class="btn btn-menu d-block d-md-none order-5" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasDoks" aria-controls="offcanvasDoks" aria-label="Open main menu">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
    </button>

    <div class="offcanvas offcanvas-start border-0 py-md-1" tabindex="-1" id="offcanvasDoks" data-bs-backdrop="true" aria-labelledby="offcanvasDoksLabel">
      <div class="header-bar d-md-none"></div>
      <div class="offcanvas-header d-md-none">
        <h2 class="h5 offcanvas-title ps-2" id="offcanvasDoksLabel"><a class="text-dark" href="/">Ego</a></h2>
        <button type="button" class="btn-close text-reset me-2" data-bs-dismiss="offcanvas" aria-label="Close main menu"></button>
      </div>
      <div class="offcanvas-body px-4">
        <h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3>
        <ul class="nav flex-column flex-md-row ms-md-n3">
          
          <li class="nav-item">
              <a class="nav-link ps-0 py-1" href="/ego/docs/prologue/introduction">Docs</a>
            </li>
          <li class="nav-item">
              <a class="nav-link ps-0 py-1" href="/ego/blog">Blog</a>
            </li>
          </ul>
        <hr class="text-black-50 my-4 d-md-none">
        <h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3>
        <ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2">
          <li class="nav-item">
              <a class="nav-link ps-0 py-1" href="/ego/https://github.com/h-enk/doks"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg><small class="ms-2 d-md-none">GitHub</small></a>
            </li>
          <li class="nav-item">
              <a class="nav-link ps-0 py-1" href="/ego/https://twitter.com/getdoks"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg><small class="ms-2 d-md-none">Twitter</small></a>
            </li>
          </ul>
      </div>
    </div>

    <button id="mode" class="btn btn-link order-md-1" type="button" aria-label="Toggle user interface mode">
      <span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span>
      <span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></span>
    </button>
    </nav>
</header>


    <div class="wrap container-xxl" role="document">
      <div class="content">
        
<div class="row justify-content-center">
  <div class="col-md-12 col-lg-10 col-xl-8">
    <article>
      <div class="blog-header">
        <h1>Cấu hình kết nối HTTPS để test Facebook app trên localhost</h1>
        <p><small>Posted 2018-05-08T20:56:31+07:00 by
  <a class="stretched-link position-relative" href="/contributors/dung-nguyen/">Dung Nguyen</a>
  
  </strong></small><p>

      </div>
      <p class="lead"></p>
      <p>Trong quá trình tìm hiểu về lập trình chat bot sử dụng các API của Facebook Messenger thì việt test chat bot trên localhost là một trở ngại.  </p><p>Khi tạo một subscription cho app chat bot, Facebook sẽ gửi một request đến server mà chat bot đang chạy để xác nhận có đúng là chat bot của bạn không. Cũng như sau đó, tất cả những tin nhắn của nguời dùng sẽ đuợc gửi tới chat bot thông qua <code class="inline">callback url</code>. Và vấn đề là khi dev và test trên localhost thì làm sao để server local của bạn có thể nhận và phản hồi request của Facebook.</p><p>Một giải pháp đơn giản là sử dụng dịch vụ của <a href="https://ngrok.com/">https://ngrok.com</a> để chuyển các request về máy localhost. <code class="inline">ngrok.com</code> cung cấp gói miễn phí test vô tư, hơn nữa <code class="inline">ngrok</code> hỗ trợ cả <code class="inline">https</code>.
Điều này rất quan trọng, bởi vì từ 2018 thì tất cả các <code class="inline">callback url</code> khi đăng ký ứng dụng trên Facebook Developer đều phải sử dụng kết nối <code class="inline">TLS</code>.</p><h2 id="buoc-1-dang-ky-tai-khoan">Buớc 1: Đăng ký tài khoản</h2><ul><li>Đăng ký tại <a href="https://ngrok.com/pricing">https://ngrok.com/pricing</a>
Vì là tài khoản miễn phí nên sẽ có một số giới hạn:</li><li>40 kết nối / phút</li><li>Mỗi lần chỉ chạy được 1 <code class="inline">ngrok</code> process</li></ul><h2 id="buoc-2-download-ngrok-va-cau-hinh-api-key">Bước 2: Download ngrok và cấu hình API key</h2><ul><li>Download tại <a href="https://ngrok.com/download">https://ngrok.com/download</a></li><li>Giải nén file vừa Download bạn sẽ có file <code class="inline">ngrok</code></li><li>Thêm token vào ngrok config bằng lệnh</li></ul><pre><code class="shell">$ ./ngrok authtoken <YOUR_AUTH_TOKEN></code></pre><p>Bạn có thể copy command trên từ <a href="https://dashboard.ngrok.com/get-started">Dashboard</a> trong phần <code class="inline">Connect your account</code></p><h2 id="buoc-3-khoi-chay-ngrok-process">Bước 3: Khởi chạy ngrok process</h2><p><strong>Chạy lệnh</strong></p><pre><code class="shell">./ngrok http <PORT></code></pre><p>trong đó <code class="inline">PORT</code> là port number của server localhost mà bạn muốn test.</p><p><strong>Ouput mẫu của <code class="inline">ngrok</code></strong></p><p><img src="/img/ngrok.png" alt="ngrok"></img></p><p><code class="inline">ngrok</code> cung cấp cho bạn 2 public URL để kết nối vào server localhost. 1 URL với giao thức <code class="inline">http</code> và 1 URL với <code class="inline">https</code>.
Ngon không nào!</p><p>Bây giờ bạn đã có thể cấu hình Facebook để test trên localhost rồi.</p><p><strong>Lưu ý:</strong><br></br>Khi sử dụng tài khoản Free, mỗi lần chạy <code class="inline">ngrok</code> thì forwarding URL sẽ khác nhau nên sẽ phải sửa lại sửa lại cấu hình app trên Facebook Developer. Đồ chùa thường là đồ chua mà. Khi sử dụng gói có phí bạn có thể cấu hình forwarding URL theo ý mình. Mình nghèo nên chịu khó thôi.</p>
    </article>
  </div>
</div>

      </div>
    </div>
    <footer class="footer text-muted">
  <div class="container-xxl">
    <div class="row">
      <div class="col-lg-8 order-last order-lg-first">
        <ul class="list-inline">
          <li class="list-inline-item">Powered by <a href="https://github.com/bluzky/ego/">Ego</a></li>
        </ul>
      </div>
      <div class="col-lg-8 order-first order-lg-last text-lg-end">
        <ul class="list-inline">
          <li class="list-inline-item"><a href="/ego/about">About me</a></li>
          <li class="list-inline-item"><a href="/ego/author">Authors</a></li>
          </ul>
      </div>
    </div>
  </div>
</footer>

    <script src="/ego/js/jquery.min.js" defer></script>
<script src="/ego/js/bootstrap.min.js" defer></script>
<script src="/ego/js/highlight.js" defer></script>
<script src="/ego/js/darkmode.js" defer></script>
<script src="/ego/js/alert.js" defer></script>
<script src="/ego/js/index.js" defer></script>

  </body>
</html>
